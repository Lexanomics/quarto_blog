library(Seurat)
library(dplyr)
library(sceasy)
# Setting Assay version 5
options(Seurat.object.assay.version = "v5")
# Load the PBMC dataset - available at 10x datasets website
pbmc.data <- Read10X(
data.dir = "/Users/affaustino/Projects/UTILS/quarto_blog/data/filtered_gene_bc_matrices/hg19")
# Initialize the Seurat object with the raw (non-normalized data).
pbmc_seurat <- CreateSeuratObject(
counts = pbmc.data, project = "pbmc3k", min.cells = 3, min.features = 200)
# The [[ operator can add columns to object metadata. This is a great place to stash QC stats
pbmc_seurat[["percent_mt"]] <- PercentageFeatureSet(pbmc_seurat, pattern = "^MT-")
pbmc_seurat <- pbmc_seurat %>%
NormalizeData(normalization.method = "LogNormalize", scale.factor = 10000) %>%
FindVariableFeatures(selection.method = "vst", nfeatures = 2000) %>%
ScaleData()
saveRDS(pbmc_seurat, file = "./data/pbmc_seurat.RDS")
pbmc_seurat <- readRDS(url("https://drive.google.com/file/d/1lmUESFx3C3UK36w7IAm7OwO9OLleM7xx/view?usp=sharing"))
url("https://drive.google.com/file/d/1lmUESFx3C3UK36w7IAm7OwO9OLleM7xx/view?usp=sharing")
library(googledrive)
#| echo: false
pbmc_seurat <- readRDS(file = "/Users/affaustino/Projects/UTILS/quarto_blog/data/pbmc_seurat.RDS")
pbmc_seurat
?future::plan
library(Seurat)
library(future)
# Setting memory limit for 8Gb
options(future.globals.maxSize = 8000 * 1024^2)
# Enabling parallelization
plan("multicore", workers = 4)
pbmc_seurat <- RunPCA(pbmc_seurat)
#| echo: false
pbmc_seurat <- RunPCA(pbmc_seurat)
#| include: false
pbmc_seurat <- RunPCA(pbmc_seurat)
pbmc_seurat <- FindNeighbors(pbmc_seurat, dims = 1:10)
pbmc_seurat <- FindClusters(pbmc_seurat,
resolution = c(0.1, 0.25, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0))
?FindClusters
#| include: false
pbmc_seurat <- FindNeighbors(pbmc_seurat, dims = 1:10)
pbmc_seurat <- FindClusters(pbmc_seurat,
resolution = c(0.1, 0.25, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0))
pbmc_markers <- FindAllMarkers(pbmc_seurat, only.pos = TRUE)
pbmc_markers %>%
group_by(cluster) %>%
dplyr::filter(avg_log2FC > 1)
pbmc_markers <- FindAllMarkers(pbmc_seurat, only.pos = TRUE)
table(pbmc_seurat$RNA_snn_res.1)
table(pbmc_seurat$seurat_clusters)
#| output: false
pbmc_markers <- FindAllMarkers(pbmc_seurat, only.pos = TRUE)
